"use strict";(()=>{function h(t,e){if(!t)throw new Error(e)}var et=34028234663852886e22,tt=-34028234663852886e22,nt=4294967295,rt=2147483647,it=-2147483648;function B(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>rt||t<it)throw new Error("invalid int 32: "+t)}function J(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>nt||t<0)throw new Error("invalid uint 32: "+t)}function V(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>et||t<tt))throw new Error("invalid float 32: "+t)}var ue=Symbol("@bufbuild/protobuf/enum-type");function le(t){let e=t[ue];return h(e,"missing enum type on enum object"),e}function j(t,e,n,i){t[ue]=z(e,n.map(r=>({no:r.no,name:r.name,localName:t[r.no]})),i)}function z(t,e,n){let i=Object.create(null),r=Object.create(null),o=[];for(let s of e){let a=de(s);o.push(a),i[s.name]=a,r[s.no]=a}return{typeName:t,values:o,findName(s){return i[s]},findNumber(s){return r[s]}}}function me(t,e,n){let i={};for(let r of e){let o=de(r);i[o.localName]=o.no,i[o.no]=o.localName}return j(i,t,e,n),i}function de(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}var b=class{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){let i=this.getType(),r=i.runtime.bin,o=r.makeReadOptions(n);return r.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){let i=this.getType(),r=i.runtime.json,o=r.makeReadOptions(n);return r.readMessage(i,e,o,this),this}fromJsonString(e,n){let i;try{i=JSON.parse(e)}catch(r){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${r instanceof Error?r.message:String(r)}`)}return this.fromJson(i,n)}toBinary(e){let n=this.getType(),i=n.runtime.bin,r=i.makeWriteOptions(e),o=r.writerFactory();return i.writeMessage(this,o,r),o.finish()}toJson(e){let n=this.getType(),i=n.runtime.json,r=i.makeWriteOptions(e);return i.writeMessage(this,r)}toJsonString(e){var n;let i=this.toJson(e);return JSON.stringify(i,null,(n=e?.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function pe(t,e,n,i){var r;let o=(r=i?.localName)!==null&&r!==void 0?r:e.substring(e.lastIndexOf(".")+1),s={[o]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[o];return Object.setPrototypeOf(s.prototype,new b),Object.assign(s,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new s().fromBinary(a,c)},fromJson(a,c){return new s().fromJson(a,c)},fromJsonString(a,c){return new s().fromJsonString(a,c)},equals(a,c){return t.util.equals(s,a,c)}}),s}var f;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(f||(f={}));var x;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(x||(x={}));function ge(){let t=0,e=0;for(let i=0;i<28;i+=7){let r=this.buf[this.pos++];if(t|=(r&127)<<i,!(r&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let i=3;i<=31;i+=7){let r=this.buf[this.pos++];if(e|=(r&127)<<i,!(r&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function v(t,e,n){for(let o=0;o<28;o=o+7){let s=t>>>o,a=!(!(s>>>7)&&e==0),c=(a?s|128:s)&255;if(n.push(c),!a)return}let i=t>>>28&15|(e&7)<<4,r=!!(e>>3);if(n.push((r?i|128:i)&255),!!r){for(let o=3;o<31;o=o+7){let s=e>>>o,a=!!(s>>>7),c=(a?s|128:s)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}var $=4294967296;function Q(t){let e=t[0]==="-";e&&(t=t.slice(1));let n=1e6,i=0,r=0;function o(s,a){let c=Number(t.slice(s,a));r*=n,i=i*n+c,i>=$&&(r=r+(i/$|0),i=i%$)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?ye(i,r):ee(i,r)}function be(t,e){let n=ee(t,e),i=n.hi&2147483648;i&&(n=ye(n.lo,n.hi));let r=Z(n.lo,n.hi);return i?"-"+r:r}function Z(t,e){if({lo:t,hi:e}=ot(t,e),e<=2097151)return String($*e+t);let n=t&16777215,i=(t>>>24|e<<8)&16777215,r=e>>16&65535,o=n+i*6777216+r*6710656,s=i+r*8147497,a=r*2,c=1e7;return o>=c&&(s+=Math.floor(o/c),o%=c),s>=c&&(a+=Math.floor(s/c),s%=c),a.toString()+he(s)+he(o)}function ot(t,e){return{lo:t>>>0,hi:e>>>0}}function ee(t,e){return{lo:t|0,hi:e|0}}function ye(t,e){return e=~e,t?t=~t+1:e+=1,ee(t,e)}var he=t=>{let e=String(t);return"0000000".slice(e.length)+e};function te(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function we(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function st(){let t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||process.env.BUF_BIGINT_DISABLE!=="1")){let r=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){let u=typeof c=="bigint"?c:BigInt(c);if(u>o||u<r)throw new Error(`int64 invalid: ${c}`);return u},uParse(c){let u=typeof c=="bigint"?c:BigInt(c);if(u>a||u<s)throw new Error(`uint64 invalid: ${c}`);return u},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,u){return t.setInt32(0,c,!0),t.setInt32(4,u,!0),t.getBigInt64(0,!0)},uDec(c,u){return t.setInt32(0,c,!0),t.setInt32(4,u,!0),t.getBigUint64(0,!0)}}}let n=r=>h(/^-?[0-9]+$/.test(r),`int64 invalid: ${r}`),i=r=>h(/^[0-9]+$/.test(r),`uint64 invalid: ${r}`);return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),i(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),n(r),Q(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),i(r),Q(r)},dec(r,o){return be(r,o)},uDec(r,o){return Z(r,o)}}}var y=st();var p;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(p||(p={}));var R=class{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let n=new Uint8Array(e),i=0;for(let r=0;r<this.chunks.length;r++)n.set(this.chunks[r],i),i+=this.chunks[r].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(J(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return B(e),te(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){V(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){J(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){B(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return B(e),e=(e<<1^e>>31)>>>0,te(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),r=y.enc(e);return i.setInt32(0,r.lo,!0),i.setInt32(4,r.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),r=y.uEnc(e);return i.setInt32(0,r.lo,!0),i.setInt32(4,r.hi,!0),this.raw(n)}int64(e){let n=y.enc(e);return v(n.lo,n.hi,this.buf),this}sint64(e){let n=y.enc(e),i=n.hi>>31,r=n.lo<<1^i,o=(n.hi<<1|n.lo>>>31)^i;return v(r,o,this.buf),this}uint64(e){let n=y.uEnc(e);return v(n.lo,n.hi,this.buf),this}},G=class{constructor(e,n){this.varint64=ge,this.uint32=we,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,i=e&7;if(n<=0||i<0||i>5)throw new Error("illegal tag: field no "+n+" wire type "+i);return[n,i]}skip(e){let n=this.pos;switch(e){case p.Varint:for(;this.buf[this.pos++]&128;);break;case p.Bit64:this.pos+=4;case p.Bit32:this.pos+=4;break;case p.LengthDelimited:let i=this.uint32();this.pos+=i;break;case p.StartGroup:let r;for(;(r=this.tag()[1])!==p.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return y.dec(...this.varint64())}uint64(){return y.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),i=-(e&1);return e=(e>>>1|(n&1)<<31)^i,n=n>>>1^i,y.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return y.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return y.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}};function N(t,e,n){if(e===n)return!0;if(t==f.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}switch(t){case f.UINT64:case f.FIXED64:case f.INT64:case f.SFIXED64:case f.SINT64:return e==n}return!1}function E(t,e){switch(t){case f.BOOL:return!1;case f.UINT64:case f.FIXED64:case f.INT64:case f.SFIXED64:case f.SINT64:return e==0?y.zero:"0";case f.DOUBLE:case f.FLOAT:return 0;case f.BYTES:return new Uint8Array(0);case f.STRING:return"";default:return 0}}function ne(t,e){let n=e===void 0,i=p.Varint,r=e===0;switch(t){case f.STRING:r=n||!e.length,i=p.LengthDelimited;break;case f.BOOL:r=e===!1;break;case f.DOUBLE:i=p.Bit64;break;case f.FLOAT:i=p.Bit32;break;case f.INT64:r=n||e==0;break;case f.UINT64:r=n||e==0;break;case f.FIXED64:r=n||e==0,i=p.Bit64;break;case f.BYTES:r=n||!e.byteLength,i=p.LengthDelimited;break;case f.FIXED32:i=p.Bit32;break;case f.SFIXED32:i=p.Bit32;break;case f.SFIXED64:r=n||e==0,i=p.Bit64;break;case f.SINT64:r=n||e==0;break}let o=f[t].toLowerCase();return[i,o,n||r]}function ke(t,e,n,i){let r;return{typeName:e,extendee:n,get field(){if(!r){let o=typeof i=="function"?i():i;o.name=e.split(".").pop(),o.jsonName=`[${e}]`,r=t.util.newFieldList([o]).list()[0]}return r},runtime:t}}function X(t){let e=t.field.localName,n=Object.create(null);return n[e]=at(t),[n,()=>n[e]]}function at(t){let e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return E(e.T,e.L);case"message":let n=e.T,i=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(i):i;case"map":throw"map fields are not allowed to be extensions"}}function xe(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}function Te(t,e,n,i){return{syntax:t,json:e,bin:n,util:i,makeMessageType(r,o,s){return pe(this,r,o,s)},makeEnum:me,makeEnumType:z,getEnumType:le,makeExtension(r,o,s){return ke(this,r,o,s)}}}function H(t,e){return e instanceof b||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}var Kt={"google.protobuf.DoubleValue":f.DOUBLE,"google.protobuf.FloatValue":f.FLOAT,"google.protobuf.Int64Value":f.INT64,"google.protobuf.UInt64Value":f.UINT64,"google.protobuf.Int32Value":f.INT32,"google.protobuf.UInt32Value":f.UINT32,"google.protobuf.BoolValue":f.BOOL,"google.protobuf.StringValue":f.STRING,"google.protobuf.BytesValue":f.BYTES};var U=Symbol("@bufbuild/protobuf/unknown-fields"),Ne={readUnknownFields:!0,readerFactory:t=>new G(t)},Ie={writeUnknownFields:!0,writerFactory:()=>new R};function ct(t){return t?Object.assign(Object.assign({},Ne),t):Ne}function ft(t){return t?Object.assign(Object.assign({},Ie),t):Ie}function Fe(){return{makeReadOptions:ct,makeWriteOptions:ft,listUnknownFields(t){var e;return(e=t[U])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[U]},writeUnknownFields(t,e){let i=t[U];if(i)for(let r of i)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,i){let r=t;Array.isArray(r[U])||(r[U]=[]),r[U].push({no:e,wireType:n,data:i})},readMessage(t,e,n,i,r){let o=t.getType(),s=r?e.len:e.pos+n,a,c;for(;e.pos<s&&([a,c]=e.tag(),c!=p.EndGroup);){let u=o.fields.find(a);if(!u){let l=e.skip(c);i.readUnknownFields&&this.onUnknownField(t,a,c,l);continue}Ee(t,e,u,c,i)}if(r&&(c!=p.EndGroup||a!==n))throw new Error("invalid end group tag")},readField:Ee}}function Ee(t,e,n,i,r){let{repeated:o,localName:s}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=s&&delete t.value,t.case=s,s="value"),n.kind){case"scalar":case"enum":let a=n.kind=="enum"?f.INT32:n.T,c=_;if(n.kind=="scalar"&&n.L>0&&(c=lt),o){let d=t[s];if(i==p.LengthDelimited&&a!=f.STRING&&a!=f.BYTES){let k=e.uint32()+e.pos;for(;e.pos<k;)d.push(c(e,a))}else d.push(c(e,a))}else t[s]=c(e,a);break;case"message":let u=n.T;o?t[s].push(C(e,new u,r,n)):t[s]instanceof b?C(e,t[s],r,n):(t[s]=C(e,new u,r,n),u.fieldWrapper&&!n.oneof&&!n.repeated&&(t[s]=u.fieldWrapper.unwrapField(t[s])));break;case"map":let[l,m]=ut(n,e,r);t[s][l]=m;break}}function C(t,e,n,i){let r=e.getType().runtime.bin,o=i?.delimited;return r.readMessage(e,t,o?i?.no:t.uint32(),n,o),e}function ut(t,e,n){let i=e.uint32(),r=e.pos+i,o,s;for(;e.pos<r;){let[a]=e.tag();switch(a){case 1:o=_(e,t.K);break;case 2:switch(t.V.kind){case"scalar":s=_(e,t.V.T);break;case"enum":s=e.int32();break;case"message":s=C(e,new t.V.T,n,void 0);break}break}}if(o===void 0){let a=E(t.K,x.BIGINT);o=t.K==f.BOOL?a.toString():a}if(typeof o!="string"&&typeof o!="number"&&(o=o.toString()),s===void 0)switch(t.V.kind){case"scalar":s=E(t.V.T,x.BIGINT);break;case"enum":s=0;break;case"message":s=new t.V.T;break}return[o,s]}function lt(t,e){let n=_(t,e);return typeof n=="bigint"?n.toString():n}function _(t,e){switch(e){case f.STRING:return t.string();case f.BOOL:return t.bool();case f.DOUBLE:return t.double();case f.FLOAT:return t.float();case f.INT32:return t.int32();case f.INT64:return t.int64();case f.UINT64:return t.uint64();case f.FIXED64:return t.fixed64();case f.BYTES:return t.bytes();case f.FIXED32:return t.fixed32();case f.SFIXED32:return t.sfixed32();case f.SFIXED64:return t.sfixed64();case f.SINT64:return t.sint64();case f.UINT32:return t.uint32();case f.SINT32:return t.sint32()}}function Oe(t,e,n,i,r){t.tag(n.no,p.LengthDelimited),t.fork();let o=i;switch(n.K){case f.INT32:case f.FIXED32:case f.UINT32:case f.SFIXED32:case f.SINT32:o=Number.parseInt(i);break;case f.BOOL:h(i=="true"||i=="false"),o=i=="true";break}switch(D(t,n.K,1,o,!0),n.V.kind){case"scalar":D(t,n.V.T,2,r,!0);break;case"enum":D(t,f.INT32,2,r,!0);break;case"message":t.tag(2,p.LengthDelimited).bytes(r.toBinary(e));break}t.join()}function re(t,e,n,i){let r=H(n.T,i);n?.delimited?t.tag(n.no,p.StartGroup).raw(r.toBinary(e)).tag(n.no,p.EndGroup):t.tag(n.no,p.LengthDelimited).bytes(r.toBinary(e))}function D(t,e,n,i,r){let[o,s,a]=ne(e,i);(!a||r)&&t.tag(n,o)[s](i)}function Se(t,e,n,i){if(!i.length)return;t.tag(n,p.LengthDelimited).fork();let[,r]=ne(e);for(let o=0;o<i.length;o++)t[r](i[o]);t.join()}function Ue(){return Object.assign(Object.assign({},Fe()),{writeField:Be,writeMessage(t,e,n){let i=t.getType();for(let r of i.fields.byNumber()){let o,s=r.localName;if(r.oneof){let a=t[r.oneof.localName];if(a.case!==s)continue;o=a.value}else o=t[s];Be(r,o,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}function Be(t,e,n,i){let r=t.repeated;switch(t.kind){case"scalar":case"enum":let o=t.kind=="enum"?f.INT32:t.T;if(r)if(t.packed)Se(n,o,t.no,e);else for(let s of e)D(n,o,t.no,s,!0);else e!==void 0&&D(n,o,t.no,e,!!t.oneof||t.opt);break;case"message":if(r)for(let s of e)re(n,i,t,s);else e!==void 0&&re(n,i,t,e);break;case"map":for(let[s,a]of Object.entries(e))Oe(n,i,t,s,a);break}}var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),q=[];for(let t=0;t<I.length;t++)q[I[t].charCodeAt(0)]=t;q[45]=I.indexOf("+");q[95]=I.indexOf("/");var ie={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),i=0,r=0,o,s=0;for(let a=0;a<t.length;a++){if(o=q[t.charCodeAt(a)],o===void 0)switch(t[a]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:s=o,r=1;break;case 1:n[i++]=s<<2|(o&48)>>4,s=o,r=2;break;case 2:n[i++]=(s&15)<<4|(o&60)>>2,s=o,r=3;break;case 3:n[i++]=(s&3)<<6|o,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,i)},enc(t){let e="",n=0,i,r=0;for(let o=0;o<t.length;o++)switch(i=t[o],n){case 0:e+=I[i>>2],r=(i&3)<<4,n=1;break;case 1:e+=I[r|i>>4],r=(i&15)<<2,n=2;break;case 2:e+=I[r|i>>6],e+=I[i&63],n=0;break}return n&&(e+=I[r],e+="=",n==1&&(e+="=")),e}};function De(t,e,n){Pe(e,t);let i=e.runtime.bin.makeReadOptions(n),r=xe(t.getType().runtime.bin.listUnknownFields(t),e.field),[o,s]=X(e);for(let a of r)e.runtime.bin.readField(o,i.readerFactory(a.data),e.field,a.wireType,i);return s()}function Je(t,e,n,i){Pe(e,t);let r=e.runtime.bin.makeReadOptions(i),o=e.runtime.bin.makeWriteOptions(i);if(oe(t,e)){let u=t.getType().runtime.bin.listUnknownFields(t).filter(l=>l.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(let l of u)t.getType().runtime.bin.onUnknownField(t,l.no,l.wireType,l.data)}let s=o.writerFactory(),a=e.field;!a.opt&&!a.repeated&&(a.kind=="enum"||a.kind=="scalar")&&(a=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(a,n,s,o);let c=r.readerFactory(s.finish());for(;c.pos<c.len;){let[u,l]=c.tag(),m=c.skip(l);t.getType().runtime.bin.onUnknownField(t,u,l,m)}}function oe(t,e){let n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(i=>i.no==e.field.no)}function Pe(t,e){h(t.extendee.typeName==e.getType().typeName,`extension ${t.typeName} can only be applied to message ${t.extendee.typeName}`)}var Le={ignoreUnknownFields:!1},Me={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function mt(t){return t?Object.assign(Object.assign({},Le),t):Le}function dt(t){return t?Object.assign(Object.assign({},Me),t):Me}function $e(t,e){let n=e(pt,Ve);return{makeReadOptions:mt,makeWriteOptions:dt,readMessage(i,r,o,s){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error(`cannot decode message ${i.typeName} from JSON: ${T(r)}`);s=s??new i;let a=new Map,c=o.typeRegistry;for(let[u,l]of Object.entries(r)){let m=i.fields.findJsonName(u);if(m){if(m.oneof){if(l===null&&m.kind=="scalar")continue;let d=a.get(m.oneof);if(d!==void 0)throw new Error(`cannot decode message ${i.typeName} from JSON: multiple keys for oneof "${m.oneof.name}" present: "${d}", "${u}"`);a.set(m.oneof,u)}Ae(s,l,m,o,i,t)}else{let d=!1;if(c?.findExtension&&u.startsWith("[")&&u.endsWith("]")){let w=c.findExtension(u.substring(1,u.length-1));if(w&&w.extendee.typeName==i.typeName){d=!0;let[k,Ze]=X(w);Ae(k,l,w.field,o,w,!0),Je(s,w,Ze(),o)}}if(!d&&!o.ignoreUnknownFields)throw new Error(`cannot decode message ${i.typeName} from JSON: key "${u}" is unknown`)}}return s},writeMessage(i,r){let o=i.getType(),s={},a;try{for(let u of o.fields.byMember()){let l;if(u.kind=="oneof"){let m=i[u.localName];if(m.value===void 0)continue;if(a=u.findField(m.case),!a)throw"oneof case not found: "+m.case;l=n(a,m.value,r)}else a=u,l=n(a,i[a.localName],r);l!==void 0&&(s[r.useProtoFieldName?a.name:a.jsonName]=l)}let c=r.typeRegistry;if(c?.findExtensionFor)for(let u of o.runtime.bin.listUnknownFields(i)){let l=c.findExtensionFor(o.typeName,u.no);if(l&&oe(i,l)){let m=De(i,l,r),d=n(l.field,m,r);d!==void 0&&(s[l.field.jsonName]=d)}}}catch(c){let u=a?`cannot encode field ${o.typeName}.${a.name} to JSON`:`cannot encode message ${o.typeName} to JSON`,l=c instanceof Error?c.message:String(c);throw new Error(u+(l.length>0?`: ${l}`:""))}return s},readScalar:(i,r,o)=>P(i,r,o,t),writeScalar:Ve,debug:T}}function T(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":`"${t.split('"').join('\\"')}"`;default:return String(t)}}function Ae(t,e,n,i,r,o){let s=n.localName;if(n.oneof){if(e===null&&n.kind=="scalar")return;t=t[n.oneof.localName]={case:s},s="value"}if(n.repeated){if(e===null)return;if(!Array.isArray(e))throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: ${T(e)}`);let a=t[s];for(let c of e){if(c===null)throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: ${T(c)}`);let u;switch(n.kind){case"message":u=n.T.fromJson(c,i);break;case"enum":if(u=se(n.T,c,i.ignoreUnknownFields,!0),u===void 0)continue;break;case"scalar":try{u=P(n.T,c,n.L,!0)}catch(l){let m=`cannot decode field ${r.typeName}.${n.name} from JSON: ${T(c)}`;throw l instanceof Error&&l.message.length>0&&(m+=`: ${l.message}`),new Error(m)}break}a.push(u)}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: ${T(e)}`);let a=t[s];for(let[c,u]of Object.entries(e)){if(u===null)throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: map value null`);let l;switch(n.V.kind){case"message":l=n.V.T.fromJson(u,i);break;case"enum":if(l=se(n.V.T,u,i.ignoreUnknownFields,!0),l===void 0)continue;break;case"scalar":try{l=P(n.V.T,u,x.BIGINT,!0)}catch(m){let d=`cannot decode map value for field ${r.typeName}.${n.name} from JSON: ${T(e)}`;throw m instanceof Error&&m.message.length>0&&(d+=`: ${m.message}`),new Error(d)}break}try{a[P(n.K,n.K==f.BOOL?c=="true"?!0:c=="false"?!1:c:c,x.BIGINT,!0).toString()]=l}catch(m){let d=`cannot decode map key for field ${r.typeName}.${n.name} from JSON: ${T(e)}`;throw m instanceof Error&&m.message.length>0&&(d+=`: ${m.message}`),new Error(d)}}}else switch(n.kind){case"message":let a=n.T;if(e===null&&a.typeName!="google.protobuf.Value"){if(n.oneof)throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: null is invalid for oneof field`);return}t[s]instanceof b?t[s].fromJson(e,i):(t[s]=a.fromJson(e,i),a.fieldWrapper&&!n.oneof&&(t[s]=a.fieldWrapper.unwrapField(t[s])));break;case"enum":let c=se(n.T,e,i.ignoreUnknownFields,o);c!==void 0&&(t[s]=c);break;case"scalar":try{t[s]=P(n.T,e,n.L,o)}catch(u){let l=`cannot decode field ${r.typeName}.${n.name} from JSON: ${T(e)}`;throw u instanceof Error&&u.message.length>0&&(l+=`: ${u.message}`),new Error(l)}break}}function P(t,e,n,i){switch(t){case f.DOUBLE:case f.FLOAT:if(e===null)return i?0:void 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;let r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==f.FLOAT&&V(r),r;case f.INT32:case f.FIXED32:case f.SFIXED32:case f.SINT32:case f.UINT32:if(e===null)return i?0:void 0;let o;if(typeof e=="number"?o=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(o=Number(e)),o===void 0)break;return t==f.UINT32?J(o):B(o),o;case f.INT64:case f.SFIXED64:case f.SINT64:if(e===null)return i?y.zero:void 0;if(typeof e!="number"&&typeof e!="string")break;let s=y.parse(e);return n?s.toString():s;case f.FIXED64:case f.UINT64:if(e===null)return i?y.zero:void 0;if(typeof e!="number"&&typeof e!="string")break;let a=y.uParse(e);return n?a.toString():a;case f.BOOL:if(e===null)return i?!1:void 0;if(typeof e!="boolean")break;return e;case f.STRING:if(e===null)return i?"":void 0;if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case f.BYTES:if(e===null)return i?new Uint8Array(0):void 0;if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return ie.dec(e)}throw new Error}function se(t,e,n,i){if(e===null)return i?t.values[0].no:void 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":let r=t.findName(e);if(r||n)return r?.no;break}throw new Error(`cannot decode enum ${t.typeName} from JSON: ${T(e)}`)}function pt(t,e,n,i){var r;if(e===void 0)return e;if(!n&&t.values[0].no===e)return;if(i)return e;if(t.typeName=="google.protobuf.NullValue")return null;let o=t.findNumber(e);return(r=o?.name)!==null&&r!==void 0?r:e}function Ve(t,e,n){if(e!==void 0)switch(t){case f.INT32:case f.SFIXED32:case f.SINT32:case f.FIXED32:case f.UINT32:return h(typeof e=="number"),e!=0||n?e:void 0;case f.FLOAT:case f.DOUBLE:return h(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case f.STRING:return h(typeof e=="string"),e.length>0||n?e:void 0;case f.BOOL:return h(typeof e=="boolean"),e||n?e:void 0;case f.UINT64:case f.FIXED64:case f.INT64:case f.SFIXED64:case f.SINT64:return h(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case f.BYTES:return h(e instanceof Uint8Array),n||e.byteLength>0?ie.enc(e):void 0}}function ve(){return $e(!0,(t,e)=>function(i,r,o){if(i.kind=="map"){let s={};switch(i.V.kind){case"scalar":for(let[c,u]of Object.entries(r)){let l=e(i.V.T,u,!0);h(l!==void 0),s[c.toString()]=l}break;case"message":for(let[c,u]of Object.entries(r))s[c.toString()]=u.toJson(o);break;case"enum":let a=i.V.T;for(let[c,u]of Object.entries(r)){h(u===void 0||typeof u=="number");let l=t(a,u,!0,o.enumAsInteger);h(l!==void 0),s[c.toString()]=l}break}return o.emitDefaultValues||Object.keys(s).length>0?s:void 0}else if(i.repeated){let s=[];switch(i.kind){case"scalar":for(let a=0;a<r.length;a++)s.push(e(i.T,r[a],!0));break;case"enum":for(let a=0;a<r.length;a++)s.push(t(i.T,r[a],!0,o.enumAsInteger));break;case"message":for(let a=0;a<r.length;a++)s.push(r[a].toJson(o));break}return o.emitDefaultValues||s.length>0?s:void 0}else{if(r===void 0)return;switch(i.kind){case"scalar":return e(i.T,r,!!i.oneof||i.opt||o.emitDefaultValues);case"enum":return t(i.T,r,!!i.oneof||i.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return H(i.T,r).toJson(o)}}})}function Re(){return{setEnumType:j,initPartial(t,e){if(t===void 0)return;let n=e.getType();for(let i of n.fields.byMember()){let r=i.localName,o=e,s=t;if(s[r]!==void 0)switch(i.kind){case"oneof":let a=s[r].case;if(a===void 0)continue;let c=i.findField(a),u=s[r].value;c&&c.kind=="message"&&!(u instanceof c.T)?u=new c.T(u):c&&c.kind==="scalar"&&c.T===f.BYTES&&(u=L(u)),o[r]={case:a,value:u};break;case"scalar":case"enum":let l=s[r];i.T===f.BYTES&&(l=i.repeated?l.map(L):L(l)),o[r]=l;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===f.BYTES)for(let[w,k]of Object.entries(s[r]))o[r][w]=L(k);else Object.assign(o[r],s[r]);break;case"message":let d=i.V.T;for(let w of Object.keys(s[r])){let k=s[r][w];d.fieldWrapper||(k=new d(k)),o[r][w]=k}break}break;case"message":let m=i.T;if(i.repeated)o[r]=s[r].map(d=>d instanceof m?d:new m(d));else if(s[r]!==void 0){let d=s[r];m.fieldWrapper?m.typeName==="google.protobuf.BytesValue"?o[r]=L(d):o[r]=d:o[r]=d instanceof m?d:new m(d)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(i=>{let r=e[i.localName],o=n[i.localName];if(i.repeated){if(r.length!==o.length)return!1;switch(i.kind){case"message":return r.every((s,a)=>i.T.equals(s,o[a]));case"scalar":return r.every((s,a)=>N(i.T,s,o[a]));case"enum":return r.every((s,a)=>N(f.INT32,s,o[a]))}throw new Error(`repeated cannot contain ${i.kind}`)}switch(i.kind){case"message":return i.T.equals(r,o);case"enum":return N(f.INT32,r,o);case"scalar":return N(i.T,r,o);case"oneof":if(r.case!==o.case)return!1;let s=i.findField(r.case);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(r.value,o.value);case"enum":return N(f.INT32,r.value,o.value);case"scalar":return N(s.T,r.value,o.value)}throw new Error(`oneof cannot contain ${s.kind}`);case"map":let a=Object.keys(r).concat(Object.keys(o));switch(i.V.kind){case"message":let c=i.V.T;return a.every(l=>c.equals(r[l],o[l]));case"enum":return a.every(l=>N(f.INT32,r[l],o[l]));case"scalar":let u=i.V.T;return a.every(l=>N(u,r[l],o[l]))}break}})},clone(t){let e=t.getType(),n=new e,i=n;for(let r of e.fields.byMember()){let o=t[r.localName],s;if(r.repeated)s=o.map(W);else if(r.kind=="map"){s=i[r.localName];for(let[a,c]of Object.entries(o))s[a]=W(c)}else r.kind=="oneof"?s=r.findField(o.case)?{case:o.case,value:W(o.value)}:{case:void 0}:s=W(o);i[r.localName]=s}return n}}}function W(t){if(t===void 0)return t;if(t instanceof b)return t.clone();if(t instanceof Uint8Array){let e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function L(t){return t instanceof Uint8Array?t:new Uint8Array(t)}var Y=class{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){let n={};for(let i of this.list())n[i.jsonName]=n[i.name]=i;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){let n={};for(let i of this.list())n[i.no]=i;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];let e=this.members,n;for(let i of this.list())i.oneof?i.oneof!==n&&(n=i.oneof,e.push(n)):e.push(i)}return this.members}};function ae(t,e){let n=He(t);return e?n:yt(bt(n))}function Ge(t){return ae(t,!1)}var Xe=He;function He(t){let e=!1,n=[];for(let i=0;i<t.length;i++){let r=t.charAt(i);switch(r){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),e=!1;break;default:e&&(e=!1,r=r.toUpperCase()),n.push(r);break}}return n.join("")}var ht=new Set(["constructor","toString","toJSON","valueOf"]),gt=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Ce=t=>`${t}$`,bt=t=>gt.has(t)?Ce(t):t,yt=t=>ht.has(t)?Ce(t):t;var K=class{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Ge(e)}addField(e){h(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}};var g=Te("proto3",ve(),Ue(),Object.assign(Object.assign({},Re()),{newFieldList(t){return new Y(t,wt)},initFields(t){for(let e of t.getType().fields.byMember()){if(e.opt)continue;let n=e.localName,i=t;if(e.repeated){i[n]=[];continue}switch(e.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=E(e.T,e.L);break;case"message":break}}}}));function wt(t){var e,n,i,r;let o=[],s;for(let a of typeof t=="function"?t():t){let c=a;if(c.localName=ae(a.name,a.oneof!==void 0),c.jsonName=(e=a.jsonName)!==null&&e!==void 0?e:Xe(a.name),c.repeated=(n=a.repeated)!==null&&n!==void 0?n:!1,a.kind=="scalar"&&(c.L=(i=a.L)!==null&&i!==void 0?i:x.BIGINT),a.oneof!==void 0){let u=typeof a.oneof=="string"?a.oneof:a.oneof.name;(!s||s.name!=u)&&(s=new K(u)),c.oneof=s,s.addField(c)}a.kind=="message"&&(c.delimited=!1),c.packed=(r=a.packed)!==null&&r!==void 0?r:a.kind=="enum"||a.kind=="scalar"&&a.T!=f.BYTES&&a.T!=f.STRING,o.push(c)}return o}var _e=class t extends b{version="";history;constructor(e){super(),g.util.initPartial(e,this)}static runtime=g;static typeName="browser.HistoryExport";static fields=g.util.newFieldList(()=>[{no:1,name:"version",kind:"scalar",T:9},{no:2,name:"history",kind:"message",T:F}]);static fromBinary(e,n){return new t().fromBinary(e,n)}static fromJson(e,n){return new t().fromJson(e,n)}static fromJsonString(e,n){return new t().fromJsonString(e,n)}static equals(e,n){return g.util.equals(t,e,n)}},F=class t extends b{visits=[];trips=[];constructor(e){super(),g.util.initPartial(e,this)}static runtime=g;static typeName="browser.History";static fields=g.util.newFieldList(()=>[{no:1,name:"visits",kind:"message",T:O,repeated:!0},{no:2,name:"trips",kind:"message",T:M,repeated:!0}]);static fromBinary(e,n){return new t().fromBinary(e,n)}static fromJson(e,n){return new t().fromJson(e,n)}static fromJsonString(e,n){return new t().fromJsonString(e,n)}static equals(e,n){return g.util.equals(t,e,n)}},O=class t extends b{id="";url="";title="";tab="";focus=[];constructor(e){super(),g.util.initPartial(e,this)}static runtime=g;static typeName="browser.Visit";static fields=g.util.newFieldList(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"title",kind:"scalar",T:9},{no:4,name:"tab",kind:"scalar",T:9},{no:5,name:"focus",kind:"message",T:S,repeated:!0}]);static fromBinary(e,n){return new t().fromBinary(e,n)}static fromJson(e,n){return new t().fromJson(e,n)}static fromJsonString(e,n){return new t().fromJsonString(e,n)}static equals(e,n){return g.util.equals(t,e,n)}},S=class t extends b{open=0;close=0;constructor(e){super(),g.util.initPartial(e,this)}static runtime=g;static typeName="browser.Focus";static fields=g.util.newFieldList(()=>[{no:1,name:"open",kind:"scalar",T:1},{no:2,name:"close",kind:"scalar",T:1}]);static fromBinary(e,n){return new t().fromBinary(e,n)}static fromJson(e,n){return new t().fromJson(e,n)}static fromJsonString(e,n){return new t().fromJsonString(e,n)}static equals(e,n){return g.util.equals(t,e,n)}},M=class t extends b{from="";to="";constructor(e){super(),g.util.initPartial(e,this)}static runtime=g;static typeName="browser.Trip";static fields=g.util.newFieldList(()=>[{no:1,name:"from",kind:"scalar",T:9},{no:2,name:"to",kind:"scalar",T:9}]);static fromBinary(e,n){return new t().fromBinary(e,n)}static fromJson(e,n){return new t().fromJson(e,n)}static fromJsonString(e,n){return new t().fromJsonString(e,n)}static equals(e,n){return g.util.equals(t,e,n)}};function qe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})}function We(t,e){return new Promise((n,i)=>{chrome.storage.local.set({[t]:e},()=>{chrome.runtime.lastError?i(chrome.runtime.lastError):n(void 0)})})}function Ye(t){return new Promise((e,n)=>{chrome.storage.local.get([t],i=>{chrome.runtime.lastError?n(chrome.runtime.lastError):e(i[t])})})}var Ke="history/get",je="history/delete";var Qe="history",ze,ce=async()=>{if(ze)return ze;try{let t=await Ye(Qe);if(t)return F.fromJson(JSON.parse(t))}catch(t){console.warn("failed to load history from localstorage",t)}return new F},fe=async t=>{We(Qe,t.toJsonString())},A=new Map,kt=()=>{function t(e){return new Promise((n,i)=>{chrome.tabs.get(e,r=>{chrome.runtime.lastError?n(void 0):n(r)})})}chrome.runtime.onMessage.addListener((e,n,i)=>(e.action===Ke&&(async()=>{let r=await ce();i({data:r.toJsonString(),status:!0})})(),e.action===je&&(async()=>(await fe(new F),i({data:{},status:!0})))(),!0)),chrome.tabs.onUpdated.addListener(async(e,n,i)=>{if(!e)return;let r=await t(e);if(r){let o=A.get(e);if(o&&(A.set(e,{...o,tab:r,prev:o.tab}),n.status==="complete")){let s=await ce();if(r.url){let a=new O({id:qe(),url:r.url,title:r.title||"",tab:e.toString(),focus:[new S({open:Date.now()})]}),c=s.visits.find(m=>m.url===r.url);c||s.visits.push(a);let u=c||a,l=s.visits.find(m=>m.url===o?.prev?.url);if(l){let m=s.visits.findIndex(w=>w.id===l.id),d=l.focus.map((w,k)=>k===l.focus.length-1?new S({...w,close:Date.now()}):w);s.visits[m]=new O({...l,focus:d}),s.trips.push(new M({from:l.id,to:u.id}))}}fe(s)}}}),chrome.windows.onFocusChanged.addListener(async e=>{if(e===chrome.windows.WINDOW_ID_NONE)return;let n=await chrome.tabs.query({active:!0,currentWindow:!0});if(n.length===1){let i=n[0];if(i.id){let r=await t(i.id);if(r){let o=await ce(),s=o.visits.find(a=>a.url===r.url);if(s){let a=o.visits.findIndex(c=>c.id===s.id);o.visits[a]=new O({...s,focus:[...o.visits[a].focus,new S({open:Date.now()})]})}fe(o)}}}}),chrome.tabs.onCreated.addListener(async e=>{if(!e.id)return;let n=await t(e.id);n&&A.set(e.id,{created:Date.now(),closed:-1,tab:n,prev:void 0})}),chrome.tabs.onRemoved.addListener(async(e,n)=>{let i=A.get(e);if(i){let r={...i,closed:Date.now()};A.set(e,r),console.log("tab was opened for",(r.closed-r.created)/1e3,"seconds")}})};kt();})();
//# sourceMappingURL=background.js.map
